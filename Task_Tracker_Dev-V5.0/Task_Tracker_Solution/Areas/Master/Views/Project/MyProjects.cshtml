@using Task_Tracker_CommonLibrary.Utility;
@model Task_Tracker_Solution.Areas.Master.Models.ProjectViewModel
@{
    ViewBag.Title = "My Projects";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="~/Content/jquery-base64-master/jquery.base64.js"></script>
<script src="~/Content/jquery-base64-master/jquery.base64.min.js"></script>

<script type="text/javascript">

    function EditProject(id) {
        //alert(id);
        try {

            Project_syscode = $.base64.encode(id);
            var url = '@Url.Action("EditProject", "Project", new { id = "_syscode" })';
            window.location.href = url.replace('_syscode', Project_syscode);

        } catch (e) {
            alert(e.message);
        }
    }
</script>
<div class="app-page-title">
    <div class="page-title-wrapper">
        <div class="page-title-heading">
            <div class="page-title-icon">
                <i class="pe-7s-portfolio icon-gradient bg-premium-dark">
                </i>
            </div>
            <div>My Projects</div>
        </div>
        <div class="page-title-actions">
            <a class="mb-2 mr-2 btn-icon btn-square btn  btn btn btn-light btn-shadow" href="../Project/CreateProject"><i class="pe-7s-ticket btn-icon-wrapper"> </i>Create Project</a>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="main-card mb-1 card">
            <div class="card-body pt-2 pb-1">
                @{
                    Html.RenderPartial("~/Areas/Tasks/Views/Task/_SearchControl.cshtml", Model.searchDTO);

                }
            </div>
        </div>

        <div class="main-card mb-2 card">

            <div class="card-body">
                <table class="mb-0 table table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center" style="width:5%">Sr No.</th>
                            <th style="width:17%">Project Name</th>
                            <th style="width:25%">Description</th>
                            <th>Created By</th>
                            <th style="width:15%">Created On</th>
                            <th class="text-center">Is Active</th>
                            <th class="text-center">Edit</th>
                            <th class="text-center">Modules</th>
                            <th class="text-center">Project Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model != null || Model.lstProjDM == null || Model.lstProjDM.Count <= 0)
                        {
                            var cnt = 0;
                            foreach (var proj in Model.lstProjDM)
                            {
                                cnt = cnt + 1;
                                string EditViewClass = string.Empty, hideClass = string.Empty;
                                if (proj.RecordHasWriteAccess)
                                {
                                    EditViewClass = "fa-edit";
                                }
                                else
                                {
                                    hideClass = "hideMe";
                                    EditViewClass = "fa-eye";
                                }
                                <tr>
                                    <td class="text-center">@cnt</td>
                                    <td>@proj.project_name</td>
                                    <td>@proj.project_description</td>
                                    <td>@proj.created_by_Name</td>
                                    <td>@Html.DisplayFor(m => proj.created_on)</td>
                                    <td>@proj.is_active.CastToYesNo()</td>
                                    <td class="text-center">
                                        <button class="border-0 btn-transition btn btn-outline-primary" onclick="EditProject(@proj.project_syscode)">
                                            <i class="fa @EditViewClass"></i>
                                        </button>
                                    </td>
                                    <td class="text-center">
                                        <a title="View" href="@Url.Action("ProjectModules", "Module", new { id = @proj.project_syscode.ToString().Base64Encode(), projname=@proj.project_name })" class="border-0 btn-transition btn btn-outline-primary">

                                            <i class="fa fa-eye"></i>
                                        </a>
                                        <a title="Add" class="@hideClass border-0 btn-transition btn btn-outline-primary" href="@Url.Action("CreateModule", "Module", new { id=@proj.project_syscode.ToString().Base64Encode(), projname=@proj.project_name })">
                                            <i class="fa fa-plus"></i>
                                        </a>
                                    </td>
                                    <td class="text-center">
                                        <a title="Add" href="@Url.Action("ProjectDetails", "Project", new { id = @proj.project_syscode.ToString().Base64Encode(), projname=@proj.project_name })" class="border-0 btn-transition btn btn-outline-primary">

                                            <i class="fa fa-plus"></i>
                                        </a>
                                    </td>
                                    <td style="display:none">@proj.project_syscode</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>



            </div>
        </div>
    </div>

</div>
